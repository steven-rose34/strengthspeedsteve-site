<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Post | Strength Speed Steve</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/gray-matter@4.0.3/dist/gray-matter.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <header>
    <h1><a href="index.html" style="color: white; text-decoration: none;">Strength Speed Steve</a></h1>
  </header>
  <main id="post-content">
    <!-- Post content will be injected here -->
  </main>
  <section id="comments">
    <h2>Comments</h2>
    <!-- Utterances comments will load here -->
  </section>
  <script>
    // Replace these placeholders with your GitHub username and repository name once the repo is created
            const owner = 'steven-rose34';
        const repo = 'strengthspeedsteve-site';

    // Helper to get slug from query parameter
    function getSlug() {
      const params = new URLSearchParams(window.location.search);
      return params.get('slug');
    }

    // Load the post content based on slug
    async function loadPost() {
      const slug = getSlug();
      const contentElement = document.getElementById('post-content');
      if (!slug) {
        contentElement.innerHTML = '<p>No post specified.</p>';
        return;
      }
      try {
        const response = await fetch(`https://raw.githubusercontent.com/${owner}/${repo}/main/posts/${slug}.md`);
        if (!response.ok) throw new Error('Post not found');
        const raw = await response.text();
        const parsed = matter(raw);
        const front = parsed.data;
        // Set page title
        document.title = `${front.title} | Strength Speed Steve`;
        // Convert markdown body to HTML
        const bodyHTML = marked.parse(parsed.content);
        // Render post
        contentElement.innerHTML = `
          <article>
            <h2>${front.title}</h2>
            <p><em>${new Date(front.date).toLocaleDateString()}</em></p>
            ${bodyHTML}
          </article>
        `;
        // Load comments for this post
        loadComments(slug);
      } catch (err) {
        console.error(err);
        contentElement.innerHTML = '<p>There was an error loading this post. Please check back later.</p>';
      }
    }

    // Load Utterances comments widget using slug as the issue term
    function loadComments(slug) {
      const commentsContainer = document.getElementById('comments');
      const script = document.createElement('script');
      script.src = 'https://utteranc.es/client.js';
      script.setAttribute('repo', `${owner}/${repo}`);
      script.setAttribute('issue-term', slug);
      script.setAttribute('label', 'comment');
      script.setAttribute('theme', 'github-light');
      script.crossOrigin = 'anonymous';
      script.async = true;
      commentsContainer.appendChild(script);
    }

    // Initialize
    loadPost();
  </script>
</body>
</html>
